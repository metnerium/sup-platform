# SUP Messenger

Ğ—Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ğ½Ğ°Ñ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ° Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑĞ¼Ğ¸ Ñ E2E ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ (Signal Protocol), WebRTC Ğ·Ğ²Ğ¾Ğ½ĞºĞ°Ğ¼Ğ¸ Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ¾Ğ¼ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑÑĞµĞ½Ğ´Ğ¶ĞµÑ€Ğ°.

## Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

- ğŸ” **E2E Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ** - Signal Protocol (X3DH + Double Ratchet)
- ğŸ’¬ **Ğ§Ğ°Ñ‚Ñ‹** - Ğ›Ğ¸Ñ‡Ğ½Ñ‹Ğµ, Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¾Ğ²Ñ‹Ğµ, ĞºĞ°Ğ½Ğ°Ğ»Ñ‹
- ğŸ“ **Ğ—Ğ²Ğ¾Ğ½ĞºĞ¸** - ĞÑƒĞ´Ğ¸Ğ¾/Ğ²Ğ¸Ğ´ĞµĞ¾ Ñ‡ĞµÑ€ĞµĞ· WebRTC (LiveKit)
- ğŸ“± **Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸** - 24-Ñ‡Ğ°ÑĞ¾Ğ²Ñ‹Ğµ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ ĞºĞ°Ğº Ğ² Instagram
- ğŸ” **ĞŸĞ¾Ğ¸ÑĞº** - ĞŸĞ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑĞ¼, Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼, Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°Ğ¼
- ğŸ­ **Ğ¡Ñ‚Ğ¸ĞºĞµÑ€Ñ‹** - Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ğ°ĞºĞ¸ ÑÑ‚Ğ¸ĞºĞµÑ€Ğ¾Ğ²
- âš¡ **Real-time** - WebSocket Ğ´Ğ»Ñ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸
- ğŸ”’ **Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ** - Rate limiting, HTTPS, security headers

## Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¡Ñ‚ĞµĞº

### Backend
- Node.js + TypeScript
- Express (REST API)
- Socket.io (WebSocket)
- PostgreSQL (Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
- Redis (ĞšĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)
- RabbitMQ (ĞÑ‡ĞµÑ€ĞµĞ´Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡)
- Kafka (Event sourcing)
- MinIO (Ğ¤Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ S3)

### Frontend
- React (Web)
- React Native (Mobile/Desktop)

### Ğ˜Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°
- Docker + Docker Compose
- Nginx (Reverse proxy)
- LiveKit (WebRTC SFU)
- Coturn (TURN/STUN)
- Prometheus + Grafana (ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³)
- Loki (Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)

## Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¡Ñ‚Ğ°Ñ€Ñ‚

### Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- Docker 24+ & Docker Compose 2+
- Node.js 20+
- npm 9+

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

1. **ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹**
```bash
git clone <repo-url> sup-messenger
cd sup-messenger
```

2. **ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ**
```bash
cp .env.example .env
# ĞÑ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ .env Ñ Ğ²Ğ°ÑˆĞ¸Ğ¼Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ğ¼Ğ¸
```

3. **Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸**
```bash
npm install
```

4. **Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ (Docker)**
```bash
docker-compose up -d
```

5. **Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ‘Ğ”**
```bash
npm run migrate
```

6. **Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ dev ÑĞµÑ€Ğ²ĞµÑ€Ñ‹**
```bash
npm run dev
```

### Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼

- **Main API**: http://localhost:3000
- **WebSocket**: http://localhost:3001
- **MinIO Console**: http://localhost:9001
- **RabbitMQ Management**: http://localhost:15672
- **Prometheus**: http://localhost:9090
- **Grafana**: http://localhost:3002

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Nginx (Reverse Proxy)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Main API â”‚         â”‚ WebSocket       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  PostgreSQL â”‚ Redis â”‚ RabbitMQ â”‚ S3  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞŸÑ€Ğ¾ĞµĞºÑ‚Ğ°

```
sup/
â”œâ”€â”€ services/              # Backend ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
â”‚   â”œâ”€â”€ main-api/         # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ API
â”‚   â”œâ”€â”€ websocket-service/ # WebSocket ÑĞµÑ€Ğ²ĞµÑ€
â”‚   â”œâ”€â”€ media-service/    # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¼ĞµĞ´Ğ¸Ğ°
â”‚   â”œâ”€â”€ worker-service/   # Background jobs
â”‚   â””â”€â”€ call-service/     # WebRTC Ğ·Ğ²Ğ¾Ğ½ĞºĞ¸
â”œâ”€â”€ clients/              # ĞšĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¸Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
â”‚   â”œâ”€â”€ web/             # React Web
â”‚   â””â”€â”€ mobile/          # React Native
â”œâ”€â”€ packages/            # Shared ĞºĞ¾Ğ´
â”‚   â”œâ”€â”€ types/          # TypeScript Ñ‚Ğ¸Ğ¿Ñ‹
â”‚   â”œâ”€â”€ utils/          # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
â”‚   â”œâ”€â”€ proto/          # gRPC proto
â”‚   â””â”€â”€ config/         # ĞĞ±Ñ‰Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ¸
â”œâ”€â”€ config/             # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
â”‚   â”œâ”€â”€ nginx/         # Nginx configs
â”‚   â””â”€â”€ grafana/       # Grafana dashboards
â”œâ”€â”€ scripts/           # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ
â””â”€â”€ docker-compose.yml # Docker orchestration
```

## Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

### ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

```bash
# Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
npm run dev              # Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
npm run dev:api          # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Main API
npm run dev:websocket    # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ WebSocket

# Ğ¡Ğ±Ğ¾Ñ€ĞºĞ°
npm run build            # Ğ¡Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ²ÑĞµ workspace

# Ğ¢ĞµÑÑ‚Ñ‹
npm test                 # Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹
npm run test:watch       # Watch mode

# Ğ›Ğ¸Ğ½Ñ‚Ğ¸Ğ½Ğ³
npm run lint             # ESLint

# Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
npm run migrate          # ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸
npm run migrate:rollback # ĞÑ‚ĞºĞ°Ñ‚Ğ¸Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ

# Docker
npm run docker:up        # ĞŸĞ¾Ğ´Ğ½ÑÑ‚ÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹
npm run docker:down      # ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹
npm run docker:logs      # ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ²
```

### E2E Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Signal Protocol Ğ´Ğ»Ñ end-to-end ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:

1. **X3DH** - Extended Triple Diffie-Hellman Ğ´Ğ»Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞµÑÑĞ¸Ğ¸
2. **Double Ratchet** - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ€Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ ĞºĞ»ÑÑ‡ĞµĞ¹
3. **Sender Keys** - Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¾Ğ²Ñ‹Ñ… Ñ‡Ğ°Ñ‚Ğ¾Ğ²

Ğ’ÑĞµ ĞºĞ»ÑÑ‡Ğ¸ Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°Ñ…. Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ğ½Ğ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ Ğ¸Ğ¼ĞµĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğ¼ ĞºĞ»ÑÑ‡Ğ°Ğ¼.

## Production Deployment

### SSL Ğ¡ĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ñ‹ (Let's Encrypt)

```bash
# Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ SSL
./scripts/init-letsencrypt.sh
```

### Backup

```bash
# Ğ ĞµĞ·ĞµÑ€Ğ²Ğ½Ğ¾Ğµ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ‘Ğ”
./scripts/backup.sh
```

### ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Grafana: http://yourdomain.com:3002
- Username: admin
- Password: admin (Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ Ğ²Ñ…Ğ¾Ğ´Ğµ)

## Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

- âœ… TLS 1.3 Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹
- âœ… E2E ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Signal Protocol)
- âœ… Rate limiting (Redis-based)
- âœ… JWT Ñ refresh token rotation
- âœ… Security headers (HSTS, CSP, etc.)
- âœ… Prepared statements (SQL injection Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°)
- âœ… CORS whitelist
- âœ… 2FA Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° (TOTP)

## Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

MIT

## ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°

- ğŸ“§ Email: support@sup-messenger.com
- ğŸ’¬ Discord: [discord link]
- ğŸ“š Documentation: [docs link]
